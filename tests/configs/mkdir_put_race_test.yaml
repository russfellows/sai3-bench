# PUT + MKDIR Race Condition Test
# 
# Tests what happens when PUT tries to write to directories that may not exist yet.
# With high concurrency, some PUT operations will fail with "parent directory not found".

target: "file:///tmp/sai3bench-mkdir-put-race/"
duration: 5s
concurrency: 16  # High concurrency to maximize race conditions

workload:
  # Create nested directories (20% of operations)
  - op: mkdir
    path: "nested/dirs/"
    weight: 20
    
  # Try to write files into those directories (80% of operations)
  # Many will fail because directory doesn't exist yet
  - op: put
    path: "nested/dirs/"
    size_distribution: 4096
    weight: 80

prepare:
  ensure_objects: []
  cleanup: true
