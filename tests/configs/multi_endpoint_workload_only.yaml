# Multi-Endpoint Distributed Test - WORKLOAD PHASE ONLY
# NO prepare phase - operates on already-prepared data
# Each agent uses its assigned endpoint directories

data_size: 524288  # 512KB

# NO prepare phase - files already exist

# Workload phase
workload:
  - op: get
    path: "testdata/*"
    use_multi_endpoint: true
    weight: 60
  - op: put
    path: "testdata/newfile-{}.dat"
    object_size: 524288
    use_multi_endpoint: true
    weight: 30
  - op: list
    path: "testdata/"
    use_multi_endpoint: true
    weight: 10

duration: 15s
concurrency: 4

# Distributed configuration with per-agent endpoint assignments
distributed:
  shared_filesystem: true
  tree_creation_mode: coordinator
  path_selection: random
  agents:
    # Agent 1: Uses endpoints A and B (should see all files after manual copy)
    - address: "localhost:7761"
      id: "agent-dc-a"
      concurrency_override: 4
      multi_endpoint:
        endpoints:
          - "file:///tmp/sai3-multi-ep-test/endpoint-a/"
          - "file:///tmp/sai3-multi-ep-test/endpoint-b/"
        strategy: round_robin
    
    # Agent 2: Uses endpoints C and D (should see all files after manual copy)
    - address: "localhost:7762"
      id: "agent-dc-b"
      concurrency_override: 4
      multi_endpoint:
        endpoints:
          - "file:///tmp/sai3-multi-ep-test/endpoint-c/"
          - "file:///tmp/sai3-multi-ep-test/endpoint-d/"
        strategy: least_connections
  
  start_delay: 2

# Performance logging
perf_log:
  enabled: true
  path: "perf_log.tsv"
  interval_seconds: 1
