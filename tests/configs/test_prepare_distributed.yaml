# Test config for distributed sai3-bench with 2 agents
# Small dataset on file:// storage (shared)

target: "file:///mnt/test/sai3-distributed-test/"

prepare:
  prepare_strategy: parallel
  directory_structure:
    width: 3
    depth: 2
    files_per_dir: 10
    distribution: "bottom"
    dir_mask: "scan.d%d_w%d.dir"
  ensure_objects:
    - base_uri: "file:///mnt/test/sai3-distributed-test/"
      count: 90  # 3x3x10 = 90 files
      min_size: 1048576  # 1 MB
      max_size: 1048576
  post_prepare_delay: 1

duration: 5s
concurrency: 2

workload:
  - op: get
    path: "scan.*/*.dat"
    weight: 100

distributed:
  shared_filesystem: true
  tree_creation_mode: coordinator  # Controller creates once, agents skip prepare
  path_selection: random  # Both agents access same files
  agents:
    - id: "agent-1"
      address: "127.0.0.1:7761"
    - id: "agent-2"
      address: "127.0.0.1:7762"
